<!-- 
When the user clicks on an answer choice, the number of correct/incorrect answers should update based on whether the answer is correct or not.
When the user clicks on an answer choice, the next question and set of answers will be displayed
The user should be able to go through at least 10 questions -->

<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<script src="https://unpkg.com/react@15/dist/react.min.js"></script>
		<script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.24.0/babel.js"></script>
	</head>

	<body>
		<div id="root"></div>
		<script type="text/babel">
			class Question extends React.Component {
				render() {
					return <h1>{this.props.question}</h1>
				}
			}
			class Correct extends React.Component {
				render() {
					let style = {
						color: 'green'
					}
					return <h2 style={style}>{this.props.answer}</h2>
				}
			}
			class Start extends React.Component {
				render() {
					// let style = {
					// 	color: 'green'
					// }
					return (
						<button
							onClick={() => {
								this.props.clickHandler(this.props.id)
							}}>
							Start New Game{' '}
						</button>
					)
				}
			}
			class Score extends React.Component {
				render() {
					return (
						<div>
							<h3>Correct: {this.props.correct}</h3>
							<h3>Incorrect: {this.props.incorrect}</h3>
							<h3>
								Question {this.props.questionId} of{' '}
								{this.props.numQuestions}
							</h3>
						</div>
					)
				}
			}

			class Answer extends React.Component {
				render() {
					return (
						<button
							style={{
								color: this.props.active ? 'red' : 'blue'
							}}
							onClick={() => {
								this.props.clickHandler(
									this.props.id,
									this.props.guess
								)
							}}>
							{this.props.guess}
						</button>
					)
				}
			}

			class Trivia extends React.Component {
				constructor(props) {
					super(props)
					this.state = {
						activeArray: [0, 0, 0, 0],
						question: 'Click to start',
						questionId: 0,
						numQuestions: 10,
						correct: 0,
						incorrect: 0,
						answer: ''
					}
					this.clickHandler = this.clickHandler.bind(this)
				}

				clickHandler() {
					// First show the correct answer

					// Then generate the new question

					// Call  generateQuestion()
					let newQuestion = generateQuestion()

					// Then shuffle the answers
					let sliced = newQuestion.slice(2, 7)
					console.log(sliced)

					// Call shuffle function on answers
					let shuffled = shuffle(sliced)
					console.log(`shuffled: ${shuffled}`)

					// setState for newQuestion
					this.setState({
						question: `What is ${newQuestion[0]} x ${
							newQuestion[1]
						}?`,
						answer: newQuestion[2],
						guess1: shuffled[0],
						guess2: shuffled[1],
						guess3: shuffled[2],
						guess4: shuffled[3]
					})
					console.log(`newQuestion: ${newQuestion}`)
					console.log(`question: ${this.state.question}`)
					console.log(`answer: ${this.state.answer}`)
					console.log(`wrong1: ${this.state.wrong1}`)
				}

				render() {
					return (
						<div>
							<Score
								correct={this.state.correct}
								incorrect={this.state.incorrect}
								questionId={this.state.questionId}
								numQuestions={this.state.numQuestions}
							/>
							<Question question={this.state.question} />
							<Correct answer={this.state.answer} />

							<Answer
								id={0}
								active={this.state.activeArray[0]}
								clickHandler={this.clickHandler}
								guess={this.state.guess1}
							/>

							<Answer
								id={1}
								active={this.state.activeArray[1]}
								clickHandler={this.clickHandler}
								guess={this.state.guess2}
							/>
							<Answer
								id={2}
								active={this.state.activeArray[2]}
								clickHandler={this.clickHandler}
								guess={this.state.guess3}
							/>
							<Answer
								id={3}
								active={this.state.activeArray[3]}
								clickHandler={this.clickHandler}
								guess={this.state.guess4}
							/>
							<Start clickHandler={this.clickHandler} />
						</div>
					)
				}
			}

			function generateQuestion() {
				let newQuestion = []
				let theQuestion1 = Math.round(10 * Math.random() + 1)
				newQuestion.push(theQuestion1)

				let theQuestion2 = Math.round(10 * Math.random() + 1)
				newQuestion.push(theQuestion2)

				let theAnswer = theQuestion1 * theQuestion2

				newQuestion.push(theAnswer)

				let solution = 0
				for (let i = 0; i < 3; i++) {
					while (
						solution == theAnswer ||
						newQuestion.includes(solution) ||
						solution == 0
					) {
						solution =
							Math.round(10 * Math.random()) *
							Math.round(10 * Math.random())
					}

					newQuestion.push(solution)
				}
				return newQuestion
			}

			function shuffle(sliced) {
				let resultArr = []
				let randomIndex = 0
				let shuffled = []

				// Generate array of random indexes 0-3
				for (let i = 0; i < 4; i++) {
					do {
						randomIndex = Math.floor(Math.random() * 4)
						console.log(randomIndex)
					} while (resultArr.includes(randomIndex))
					resultArr.push(randomIndex)
					// console.log(`result arr: ${resultArr}`)
				}
				// sample data 1,0,3,2
				for (let i = 0; i < 4; i++) {
					shuffled.push(sliced[resultArr[i]])
					// console.log(shuffled)
				}
				return shuffled
			}

			ReactDOM.render(<Trivia />, document.getElementById('root'))
		</script>
	</body>
</html>
